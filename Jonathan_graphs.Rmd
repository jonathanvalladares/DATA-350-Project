---
title: "graphs"
author: "DATA350"
date: "2025-10-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(NHANES)
library(tidyverse)
library(ggthemes)
library(scales)
library(patchwork)
library(labelled)

```

```{r, include=TRUE}
data("NHANESraw")
glimpse(NHANESraw)

```
```{r}
data_dict_labelled <- look_for(NHANESraw)
print(data_dict_labelled)
```

```{r, include=FALSE}

data("NHANES")

nhanes_clean <- NHANES |>
  select(Age, Gender, Race1, BMI, Diabetes, BPSysAve,
         Alcohol12PlusYr, Marijuana, HardDrugs) |>
  filter(!is.na(Age), !is.na(Gender), !is.na(Race1)) |>
  mutate(
    AgeGroup = cut(Age, breaks = c(0, 20, 40, 60, 80),
                   labels = c("0–20","21–40","41–60","61–80"))
  )


```
## How do demographic factors correlate with physical/mental health and disease development?
```{r}
ggplot(nhanes_clean, aes(x = BMI, fill = Diabetes)) +
  geom_density(alpha = 0.5) +
  facet_wrap(~Race1) +
  labs(
    title = "BMI Distribution by Diabetes Status, Faceted by Race",
    x = "Body Mass Index (BMI)",
    y = "Density",
    fill = "Diabetes"
  ) +
  theme_economist_white()



```

## What relationships exist between demographic information and alcohol/substance use?

```{r}

nhanes_sub <- nhanes_clean |>
  pivot_longer(cols = c(Alcohol12PlusYr, Marijuana, HardDrugs),
               names_to = "Substance", values_to = "Used") |>
  filter(!is.na(Used))


ggplot(nhanes_sub, aes(x = Gender, fill = Used)) +
  geom_bar(position = "dodge") +   # side-by-side bars for clarity
  geom_text(
    stat = "count",
    aes(label = after_stat(count)),
    position = position_dodge(width = 0.9),
    vjust = -0.4,
    size = 3
  ) +
  facet_wrap(~Substance) +
  labs(
    title = "Substance Use by Gender (with Respondent Counts)",
    x = "Gender",
    y = "Number of Respondents",
    fill = "Used (Yes/No)"
  ) +
  theme_minimal()


```

